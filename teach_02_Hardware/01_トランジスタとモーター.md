# トランジスタとモーター

本記事では、電流を制御するための最小単位としてトランジスタの仕組みについて理解し、実際にマイコンを用いてモーターを制御することを目標とします。  
また、モーターや電磁弁のような力学的な動作を行う素子を「**アクチュエーター**」と呼びます。

## トランジスタとは？

電子工作に興味がある人もない人も恐らく「トランジスタ」という言葉を聞いたことはあるのではないでしょうか。このトランジスタは電気的に動作する「**スイッチ**」に該当し、物理的なスイッチに比べて小型化できたり、高速でON/OFFを切り替えたりすることが可能な部品です。  
半導体やマイコンの中ではこいつらが活躍してくれているので、まずは電子工作の基礎としてトランジスタについて理解していきます。

## 準備するもの
* [AE-RP2040](https://akizukidenshi.com/catalog/g/gK-17542/)
* [ジャンパワイヤ](https://akizukidenshi.com/catalog/g/gC-05159/)(リンクは参考)
* [ブレッドボード](https://akizukidenshi.com/catalog/g/gP-05294/)(リンクは参考)
* [Nch MOSFET](https://akizukidenshi.com/catalog/g/gI-07597/)
* [DCモーター]()
* PCとマイコンをつなぐケーブル

>**トランジスタの特徴**
>>
>>* 増幅作用  
>>* スイッチング作用  
>>

たとえば、最近のCPUの中には指先のサイズの中に数億個ものトランジスタが組み込まれているそうです。

まずはトランジスタの原理を軽く説明した後に、実際にトランジスタの一種である「**MOSFET**」という部品を用いてモーターを回す事により、トランジスタの原理を体験していきたいと思います。

## トランジスタの原理
高校の物理で扱った通り、半導体にはP型とN型の2種類があります。Positiveを表すP型半導体にはプラス電荷が、Negativeを表すN型にはマイナス電荷が収納されていると思ってください。  
この２種類の半導体をサンドイッチ構造にすることで、トランジスタは構成されます。

![トランジスタの図](https://detail-infomation.com/wp-content/uploads/2020/04/%E3%83%90%E3%82%A4%E3%83%9D%E3%83%BC%E3%83%A9%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B8%E3%82%B9%E3%82%BF%E3%81%AE%E3%80%8E%E9%A7%86%E5%8B%95%E6%96%B9%E6%B3%95%E3%80%8F-600x406.jpg)

挟んである順に、**NPN型トランジスタ・PNP型トランジスタ**と呼ばれます。3つの半導体にはそれぞれ名前がついており、端から**E(エミッタ)、B(ベース)、C(コレクタ)** と言います。  

ここから先の説明はNPN型半導体を代表して説明していきます。  
トランジスタは、エミッタ-コレクタ間に電流を流したいときに使います。しかし、エミッタ-コレクタ間に電圧を加えると、N型半導体の中の電子が図の右側に引き寄せられます。(ここでベースには何も接続されていないものとします)  
同時に、P型半導体の中の電子がエミッタ側のN型半導体の中の電子に引き寄せられ、左に移動します。  
すると、ベース-コレクタ半導体の境界付近は電荷が存在しない状態になり、エミッタ-コレクタ間は絶縁されています。  

しかし、ここでエミッタと負極を共有する形でベースに正極をつなぐように電圧をかけると(上図参照)、ベースとエミッタの半導体内がいい感じに飽和して偏りがなくなるので、エミッタ-コレクタ間が導通するようになります。  
※この説明はめちゃくちゃ適当なのでちゃんと知りたい人はググってください。[村田製作所の動画](https://article.murata.com/ja-jp/article/what-is-transistor)が分かりやすいです。

ここで大事なのは、**ベース-エミッタ間に加える電圧は小さくてもいい** ということです。

ベースに電圧を加えるかどうかでエミッタ-コレクタ間に電流が流れるか決まる。これが**スイッチング作用** です。  
そして、ベース-エミッタ間に小さい電流を流すだけでエミッタ-コレクタ間に大電流を流すことができる、これが**増幅作用** になります。  

| 作用 | 効果 |
| ---- | ----|
| スイッチング作用 | ベースに電圧を加えるかどうかでエミッタコレクタ間に電流を流すかどうか決める |
| 増幅作用 | ベース-エミッタ間に小さい電流を流すだけでコレクタ-コレクタ間に大きな電流を流せる |
---

## トランジスタの分類
トランジスタには上の章で紹介した「**NPN型トランジスタ**」の他に、半導体の並びを逆転させた「**PNP型トランジスタ**」もあります。PNP型では逆に、「ベースに電圧を加えている間エミッタ-コレクタ間に電流が流れなくなる」という事が起こります。

トランジスタと同じような動作をする部品に、**FET**があります。~~F.T.E.？それは東北大の宇宙開発サークルです。~~  
こちらの部品の詳細な説明は省きますが、トランジスタに対して以下のような特徴があります。
||トランジスタ|FET|
| :----: | ---- | ----|
|信号増幅    |100倍程度まで増幅でき**性能が高い**   |10倍程度の増幅能力であり**性能が低い**   |
|スイッチング| スイッチングが得意ではない | 高速スイッチングが可能である(データシート参照)  |
|電力        | 僅かなベース電流で駆動できるので省電力向き。ただし大電流を流そうとすると比例してベース電流もくうので不向き | オンにする瞬間はゲート電流を多く消費するが、一度オンすれば殆ど流れないので大電流に向いている  |

> 上記の選び方は一般的な場合であり、FETで信号増幅したり、トランジスタで大電力を扱うことが可能な製品もあります。
但し、あまり特殊なタイプのものを選ぶと、その部品が廃止(ディスコン)になった時に代替品が無くて困ることになります。
選定の際は、部品形状も含めて代替可能な製品があることも考慮に入れるようにします。  
(ブログ「アナデジ太郎の回路設計」より引用)

## 作成する回路

今回はMOSFETを用いてモーターを回します。
マイコンのoutputピンでモーターを直接まわせばいいじゃないと思うかも知れませんが、電子工作においてモーター等のアクチュエータが数100mAや数Aやのオーダーであるのに対し、センサ類の通信では電流が数mAや数10mAなので、マイコンの回路が焼き切れてしまいます。

## 使用するプログラム

```py
#GPIOを制御するためのライブラリをimport
from machine import Pin
#時間を制御するためのライブラリをimport
import time

#13番ピンを出力(OUT)に設定
gate = Pin(13, Pin.OUT)

#インデント内のコードを3回実行
for i in range(3):
    gate.value(0)#gate出力を0に
    time.sleep(3)#3秒待機
    gate.value(1)#gate出力を1に
    time.sleep(3)#3秒待機

#最後に出力を0にしておくことを忘れない
gate.value(0)
print("finish")
```

## 作業時の注意

ブレッドボードを用いて作業する時の注意点は以下の通りです。

* 配線中はブレッドボードの足や部品の足が他のピン等に触れないように注意する。(ブリッジしてショートすると悲惨)
* MOSFETのような部品は向きを間違えないように注意して配線する。(向きのある部品を逆接すると発火・爆発の恐れあり)

## 参考

* <https://detail-infomation.com/bipolar-transistor/>
* <https://article.murata.com/ja-jp/article/what-is-transistor>
* https://ana-dig.com/transistor_fet/